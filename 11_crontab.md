# 12_crontab.md — Cron & Crontab

## 🕒 مقدمة
`cron` هو system daemon بيُستخدم لتشغيل المهام المجدولة تلقائيًا في أوقات محددة.  
`crontab` هو ملف بيحتوي على قائمة المهام وجدولها الزمني.

## 🧩 الفرق بين cron وcrontab

| العنصر     | الوظيفة                                  |
|------------|-------------------------------------------|
| `cron`     | الخدمة المسؤولة عن تنفيذ المهام المجدولة |
| `crontab`  | الملف اللي بيحدد متى وإزاي تتنفذ المهام   |

## 📌 تركيب ملف Crontab

صيغة كل سطر:
```
* * * * * command_to_execute
│ │ │ │ │
│ │ │ │ └─── Day of the Week (0 - 7) (Sun=0 or 7)
│ │ │ └───── Month (1 - 12)
│ │ └─────── Day of the Month (1 - 31)
│ └───────── Hour (0 - 23)
└─────────── Minute (0 - 59)
```

## ✅ أمثلة

| جدول                 | مثال                                       | الوصف                          |
|----------------------|--------------------------------------------|--------------------------------|
| كل دقيقة              | `* * * * * echo "hi"`                      | يشغّل الأمر كل دقيقة           |
| كل ساعة              | `0 * * * * script.sh`                      | أول دقيقة من كل ساعة          |
| كل يوم الساعة 7 صباحًا | `0 7 * * * backup.sh`                     | يوميًا الساعة 7 صباحًا        |
| كل يوم أحد           | `0 9 * * 0 weekly.sh`                      | الساعة 9 صباحًا كل يوم أحد    |
| أول يوم في الشهر     | `0 0 1 * * run_report.sh`                 | عند منتصف الليل أول يوم شهريًا|

## 🔁 رموز خاصة

| الرمز       | المعنى                          |
|-------------|----------------------------------|
| `*`         | أي قيمة                          |
| `,`         | فصل بين قيم مختلفة               |
| `-`         | نطاق (range)                     |
| `/`         | خطوة (مثال: */10 = كل 10 دقائق) |

**مثال:**
```
*/15 9-17 * * 1-5 task.sh
```
⇨ كل 15 دقيقة من الساعة 9 لـ 5 مساءً من الإثنين للجمعة.

## 👨‍💻 أوامر التعامل مع Crontab

| الأمر                         | الوظيفة                                 |
|------------------------------|------------------------------------------|
| `crontab -e`                 | تعديل ملف المهام للمستخدم الحالي        |
| `crontab -l`                 | عرض المهام المجدولة                     |
| `crontab -r`                 | حذف كل المهام للمستخدم الحالي           |
| `sudo crontab -e -u user`    | تعديل crontab لمستخدم معين              |

## 📂 ملفات نظام مهمة

| الملف                         | الوصف                                      |
|------------------------------|---------------------------------------------|
| `/etc/crontab`               | ملف cron الرئيسي للنظام                    |
| `/etc/cron.d/`               | ملفات مجدولة بصيغة crontab لنظام كامل     |
| `/var/log/syslog`            | يحتوي على لوج تشغيل cron (Debian/Ubuntu)  |
| `/var/log/cron`              | لوج cron على بعض توزيعات RedHat/CentOS    |

## 🛠 نصائح

- دائمًا استخدم المسار الكامل للأوامر (مثال: `/usr/bin/python3`)
- اختبر الأمر يدويًا قبل إضافته إلى crontab
- أضف سجل (log) لنتائج المهام:
  ```
  * * * * * /path/script.sh >> /var/log/script.log 2>&1
  ```